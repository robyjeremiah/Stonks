{% load static %}

<!DOCTYPE html>
<html>

<head>
    <title>Create an Account</title>
    <link rel="stylesheet" type="text/css" href="{% static 'newUser.css' %}">
    <link rel="icon" type="image/png" href="{%static 'Stonks.png' %}">
    <script type="text/javascript" src="{% static '/js/jquery-3.6.0.js' %}"></script>
</head>
<script>
    $(document).ready(function () {
        validatePassword();
        confirmPassword();
    })

    function validatePassword(){
        $("#password").focus(function () {
            $("#message").show();
        })

        $("#password").blur(function () {
            $("#message").hide();
        })

        $('#password').keyup(function(){
            // Validates lowercase for password
            var value = this.value;
            var lowerCaseletters = /[a-z]/g;
            if(lowerCaseletters.test(value)){
                $('#letter').removeClass('invalid');
                $('#letter').addClass('valid');
            } else {
                $('#letter').removeClass('valid');
                $('#letter').addClass('invalid');
            }
        })

        $('#password').keyup(function(){
            // Validates uppercase for password
            var value = this.value;
            var upperCaseLetters = /[A-Z]/g;
            if(upperCaseLetters.test(value)){
                $('#capital').removeClass('invalid');
                $('#capital').addClass('valid');
            } else {
                $('#capital').removeClass('valid');
                $('#capital').addClass('invalid');
            }
        })

        $('#password').keyup(function(){
            // Validates numbers for password
            var value = this.value;
            var numbers = /[0-9]/g;
            if(numbers.test(value)){
                $('#number').removeClass('invalid');
                $('#number').addClass('valid');
            } else {
                $('#number').removeClass('valid');
                $('#number').addClass('invalid');
            }
        })

        $('#password').keyup(function(){
            // Validate length
            var value = this.value;
            if(value.length >= 8) {
                $('#length').removeClass('invalid');
                $('#length').addClass('valid');
            } else {
                $('#length').removeClass('valid');
                $('#length').addClass('invalid');
            }
        })
    }

    function confirmPassword(){
        $('#submit').click(function(){
            var password = $('#password').val();
            var confirmPass = $('#confirmPassword').val();

            if(password != confirmPass){
                generateAlert('fail');
                alert('Passwords did not match.');
            } else {
                generateAlert('success');
                alert('Password created successfully!');
            }
        })
    }

    function generateAlert(classType){
        $(".newUserAccount").prepend('You have successfully created an account!').addClass(classType);
    }
</script>

<body>
    <form method="POST" action="/">
        {% csrf_token %}
        <div id="message" style="display: none;">
            <h3>Password must contain the following:</h3>
            <p id="letter" class="invalid">A <b>lowercase</b> letter</p>
            <p id="capital" class="invalid">First character is <b>capital (uppercase)</b> letter</p>
            <p id="number" class="invalid">A <b>number</b></p>
            <p id="length" class="invalid">Minimum <b>8 characters</b></p>
        </div>
        <div class="newUserAccount">
            <h1>Create an Account</h1>
            <input type="fname" name="lname" id="fname" placeholder="First Name">
            <input type="lname" name="fname" id="lname" placeholder="Last Name">
            <input type="email" name="email" id="email" placeholder="Email">
            <input type="date" name="date" id="date" placeholder="Date of Birth">
            <input type="password" id="password" name="password" placeholder="Password"
                pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}" required
                title="Must be a minimum of 8 characters, first letter is capitalized, and has mixed letters/numbers">
            <input type="password" id="confirmPassword" placeholder="Confirm Password">
            <input type="submit" id="submit" name="Submit" value="Create Account">
            <a href="/">Already have an account?</a><br>
        </div>
    </form>
</body>

</html>